
<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>–ò–∑–±—Ä–∞–Ω–Ω–æ–µ</title>
  <style>
    body { font-family: sans-serif; padding: 20px; }
    .book { border: 1px solid #ccc; border-radius: 10px; padding: 15px; margin-bottom: 15px; }
    input { padding: 10px; width: 100%; margin-bottom: 20px; font-size: 16px; }
    .export-btn { background: #4CAF50; color: white; border: none; padding: 10px 15px; border-radius: 6px; cursor: pointer; }
  </style>
</head>
<body>

<nav style="margin-bottom: 20px;">
  <a href="index.html" style="margin-right: 10px;">üè† –ì–ª–∞–≤–Ω–∞—è</a>
  <a href="cat2.html" style="margin-right: 10px;">üìö –ö–Ω–∏–≥–∏ –Ω–∞ —Ä–∞–∑–Ω—ã–µ —Ç–µ–º—ã</a>
  <a href="cat3.html" style="margin-right: 10px;">üìñ –ö–Ω–∏–≥–∏ –ø–æ –ò—Å—Ç–æ—Ä–∏–∏ –†–µ–ª–∏–≥–∏–∏</a>
  <a href="favorites.html">‚≠ê –ò–∑–±—Ä–∞–Ω–Ω–æ–µ</a>
</nav>


<nav style="margin-bottom: 20px;">
  <a href="index.html" style="margin-right: 10px;">üè† –ì–ª–∞–≤–Ω–∞—è</a>
  <a href="cat2.html" style="margin-right: 10px;">üìö –¢–µ–º—ã</a>
  <a href="cat3.html" style="margin-right: 10px;">üìñ –†–µ–ª–∏–≥–∏—è</a>
  <a href="favorites.html">‚≠ê –ò–∑–±—Ä–∞–Ω–Ω–æ–µ</a>
</nav>

  <div id="content">
    <h1>–ò–∑–±—Ä–∞–Ω–Ω—ã–µ –∫–Ω–∏–≥–∏</h1>
    <input type="text" id="searchInput" placeholder="–ü–æ–∏—Å–∫...">
    <div id="favList"></div>
    <button class="export-btn" onclick="exportFavorites()">–í—ã–≥—Ä—É–∑–∏—Ç—å –∏–∑–±—Ä–∞–Ω–Ω–æ–µ</button>
  </div>


<script>
document.addEventListener('DOMContentLoaded', () => {
  const correctPassword = '2424';
  const auth = document.getElementById('auth');
  const content = document.getElementById('content');
  const favorites = JSON.parse(localStorage.getItem('favorites') || '[]');

  const input = document.getElementById('passwordInput');
  input.addEventListener('keyup', function(e) {
    if (e.key === 'Enter') {
      if (this.value === correctPassword) {
        auth.style.display = 'none';
        content.style.display = 'block';
        if (typeof renderBooks === 'function') renderBooks();
        if (typeof renderFavorites === 'function') renderFavorites();
      } else {
        this.style.borderColor = 'red';
      }
    }
  });

  if (localStorage.getItem('authPassed') === 'true') {
    auth.style.display = 'none';
    content.style.display = 'block';
    if (typeof renderBooks === 'function') renderBooks();
    if (typeof renderFavorites === 'function') renderFavorites();
  }

  window.toggleFavorite = function(btn) {
    const book = btn.closest('.book');
    const id = book.dataset.id;
    const index = favorites.indexOf(id);
    if (index >= 0) {
      favorites.splice(index, 1);
      book.classList.remove('favorited');
    } else {
      favorites.push(id);
      book.classList.add('favorited');
    }
    localStorage.setItem('favorites', JSON.stringify(favorites));
    if (typeof renderFavorites === 'function') renderFavorites();
  }

  window.favorites = favorites;
});
</script>

<script>
function renderFavorites() {
  const list = document.getElementById('favList');
  const filter = document.getElementById('searchInput');
  list.innerHTML = '';
  const favBooks = books.filter(b => favorites.includes(b.id));
  filter.addEventListener('input', () => {
    const val = filter.value.toLowerCase();
    document.querySelectorAll('.book').forEach(b => {
      b.style.display = b.innerText.toLowerCase().includes(val) ? '' : 'none';
    });
  });
  favBooks.forEach(b => {
    const div = document.createElement('div');
    div.className = 'book';
    div.innerHTML = `
      <h3>${b.title}</h3>
      <p><strong>–ê–≤—Ç–æ—Ä:</strong> ${b.author}</p>
      <p><strong>–û–ø–∏—Å–∞–Ω–∏–µ:</strong> ${b.description}</p>
      <p><strong>–ö–∞—Ç–µ–≥–æ—Ä–∏—è:</strong> ${b.category_title}</p>
      <p><strong>–¶–µ–Ω–∞:</strong> ${b.price} ‚ÇΩ</p>
    `;
    list.appendChild(div);
  });
}

function exportFavorites() {
  const favBooks = books.filter(b => favorites.includes(b.id));
  let csv = '–ù–∞–∑–≤–∞–Ω–∏–µ\t–ê–≤—Ç–æ—Ä\t–û–ø–∏—Å–∞–Ω–∏–µ\t–ö–∞—Ç–µ–≥–æ—Ä–∏—è\t–¶–µ–Ω–∞\n';
  favBooks.forEach(b => {
    csv += `${b.title}\t${b.author}\t${b.description}\t${b.category_title}\t${b.price} ‚ÇΩ\n`;
  });
  const blob = new Blob([csv], { type: 'text/tab-separated-values' });
  const link = document.createElement('a');
  link.href = URL.createObjectURL(blob);
  link.download = '–∏–∑–±—Ä–∞–Ω–Ω—ã–µ_–∫–Ω–∏–≥–∏.xls';
  link.click();
}
</script>
<script src="books.js"></script>
</body>
</html>
